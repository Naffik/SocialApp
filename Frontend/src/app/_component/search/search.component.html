<div class="content">
    <div class="header">
        <button (click)="goBack()">
            <i class="fa fa-arrow-left"></i>
        </button>
        <div class="search-box">
            <img src="/assets/search.png" alt="search icon">
            <input [(ngModel)]="searchQuery" (keyup.enter)="onSearch()" placeholder="Wyszukaj posty...">
        </div>
        <div class="spacer"></div> <!-- Dodane, aby zajmować przestrzeń po prawej stronie -->
    </div>
    <div class="search-results" *ngIf="searchResults.length > 0">
        <div infiniteScroll [infiniteScrollDistance]="10" 
            [infiniteScrollThrottle]="50" 
            (scrolled)="loadMoreResults()">
            <div *ngFor="let result of searchResults" class="comment" @fadeIn>
              <div class="post-header">
                <!-- Avatar with mouse enter and leave events -->
                <a [routerLink]="['/', result.post_author]">
                  <img [src]="baseUrl + result?.post_author_avatar"
                       (mouseenter)="showPopover(result.id, result.post_author)" 
                       (mouseleave)="hidePopover()"
                       alt="Avatar użytkownika piszącego post" 
                       class="avatar">
                </a>
            
                <!-- Display name with mouse enter and leave events -->
                <a [routerLink]="['/', result.post_author]">
                  <span class="username"
                        (mouseenter)="showPopover(result.id, result.post_author)"
                        (mouseleave)="hidePopover()">
                    <strong>{{ result?.display_name }}</strong>
                  </span>
                </a>
            
                <!-- Nickname (username) with mouse enter and leave events -->
                <a [routerLink]="['/', result.post_author]">
                  <span class="nick"
                        (mouseenter)="showPopover(result.id, result.post_author)" 
                        (mouseleave)="hidePopover()">
                    @{{ result?.post_author }}
                  </span>
        
                </a>
                <span class="date">
                  {{ result?.created | timeSince }}
                  <!-- <span class="tooltip">
                    {{ result?.created | dateFormat }}
                  </span> -->
                </span>
                <div class="menu-icon-container" (click)="stopPropagation($event)">
                  <button (click)="toggleContextMenu(result.id)">
                    <i class="fa fa-ellipsis-v"></i>
                  </button>
        
              </div>
              </div>
              <div class="post-content">
                <div class="preserve-whitespace" [innerHTML]="result?.content | linkify : result?.id">
                  <!-- reszta treści postu -->
                </div>
                <div *ngIf="result?.image" class="post-image">
                  <img [src]="baseUrl + result?.image" alt="Image for {{ result?.post }}" style="cursor: pointer" />
                </div>
                <div class="tags">
                  <p>Tags:</p>
                  <div class="tag-container">
                    <span *ngFor="let tag of result?.tags">{{ tag }}</span>
                  </div>
                </div>
              </div>
              
              <div class="post-actions">
                <!-- Ikonka polubienia -->
                <button class="like-btn" [class.liked]="result.is_liked" (click)="stopPropagation($event)">
                  <i class="fa fa-thumbs-up"> </i>
                  <span class="count" [class.liked]="result.is_liked"> 
                    {{result.number_of_likes}}
                  </span>
                </button>
            
                <!-- Ikonka komentarza -->
                <button class="comment-btn">
                  <i class="fa fa-comment"></i>
                  <span class="count">{{result.number_of_comments}} </span>
                </button>
            
                <!-- Ikonka udostępnienia -->
                <button class="share-btn" (click)="sharePost(result.id); stopPropagation($event)">
                  <i class="fa fa-share"></i> 
                </button>
              </div>
              <hr />
            </div>
            <div *ngIf="isLoading">
              <div class="spinner"></div>
              <p class="loading-text">
                Loading<span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>
              </p>
            </div>
          </div>
    </div>
    <div class="trends" *ngIf="searchResults.length === 0">
        <app-trends></app-trends>
    </div>
</div>
